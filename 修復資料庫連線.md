# 修復資料庫連線錯誤

## 問題說明

錯誤訊息：`Access denied for user 'root'@'localhost' (using password: YES)`

這表示：
1. ✅ cryptography 已安裝成功（能嘗試連接了）
2. ❌ 資料庫密碼錯誤或配置不正確

## 解決方案

### 步驟 1: 檢查 .env 檔案

確認 `backend/.env` 檔案中的資料庫設定：

```env
DB_ENGINE=django.db.backends.mysql
DB_NAME=issue_system
DB_USER=root
DB_PASSWORD=你的MySQL密碼  ← 確認這裡的密碼是否正確
DB_HOST=localhost
DB_PORT=3306
```

**重要**：確認 `DB_PASSWORD` 是否與你的 MySQL root 密碼一致。

### 步驟 2: 測試 MySQL 連線

在 CMD 中測試：

```cmd
mysql -u root -p
```

輸入密碼，如果能成功連接，說明密碼正確。

### 步驟 3: 確認資料庫已建立

在 MySQL 中執行：

```sql
SHOW DATABASES;
```

確認是否有 `issue_system` 資料庫。如果沒有，執行：

```sql
CREATE DATABASE issue_system CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 步驟 4: 檢查用戶權限

在 MySQL 中執行：

```sql
SELECT user, host FROM mysql.user WHERE user='root';
```

確認 root 用戶存在且可以從 localhost 連接。

### 步驟 5: 如果忘記 MySQL 密碼

**Windows 重置 MySQL root 密碼：**

1. 停止 MySQL 服務：
```cmd
net stop MySQL80
```

2. 使用安全模式啟動 MySQL：
```cmd
mysqld --console --skip-grant-tables --shared-memory
```

3. 開啟新的 CMD 視窗，連接到 MySQL：
```cmd
mysql -u root
```

4. 在 MySQL 中執行：
```sql
ALTER USER 'root'@'localhost' IDENTIFIED BY '新密碼';
FLUSH PRIVILEGES;
EXIT;
```

5. 停止安全模式的 MySQL，重新啟動正常服務。

## 快速檢查清單

- [ ] `.env` 檔案中的 `DB_PASSWORD` 是否正確
- [ ] MySQL 服務是否啟動
- [ ] 資料庫 `issue_system` 是否已建立
- [ ] 可以使用 `mysql -u root -p` 成功連接

## 測試連線

修改 `.env` 後，重新執行：

```cmd
cd C:\Users\FAE\issue-system\backend
.venv\Scripts\activate.bat
python manage.py check --database default
```

如果顯示 "System check identified no issues"，表示連線成功。

